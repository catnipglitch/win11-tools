## 計画

### 1. ツール名

BingBlocker

### 2. 機能

*   レジストリのバックアップ
*   レジストリの検索と対象キーの特定
*   レジストリキーの書き換え（Bing検索の無効化/有効化）
*   再起動の促し

### 3. 入力

なし（コマンドラインツール）

### 4. 出力

*   成功/失敗メッセージ
*   レジストリバックアップファイル

### 5. 必要な情報

*   レジストリキーのパス: `HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Explorer` (Explorerキーがない場合は作成)
*   DWORD値の名前: `DisableSearchBoxSuggestions`
*   DWORD値:
    *   Bing検索無効化: `1`
    *   Bing検索有効化: `0`

### 6. 処理の流れ

1.  **管理者権限の確認:** ツールが管理者権限で実行されているか確認する。
2.  **レジストリのバックアップ:** 指定されたレジストリキーをバックアップする。
3.  **レジストリキーの存在確認:** 指定されたレジストリキーが存在するか確認する。存在しない場合は、キーを作成する。
4.  **DWORD値の作成/変更:** `DisableSearchBoxSuggestions`という名前のDWORD値を作成または変更する。
5.  **設定の有効化:** Bing検索を無効化/有効化するために、システムの再起動を促すメッセージを表示する。
6.  **エラー処理:** 上記の処理中にエラーが発生した場合は、適切なエラーメッセージを表示する。

### 7. 技術的な詳細

*   **言語:** PowerShell
*   **管理者権限:** 必須
*   **レジストリ操作:** PowerShellの`Get-Item`, `New-Item`, `Set-ItemProperty`コマンドレットを使用
*   **再起動:** PowerShellの`Restart-Computer`コマンドレットを使用

### 8. 補足事項

*   レジストリのバックアップは、元の状態に戻せるようにするために重要です。
*   エラー処理を適切に行うことで、ツールの信頼性を高めます。
*   再起動を促すメッセージは、ユーザーにわかりやすく伝える必要があります。

### Mermaid図

```mermaid
graph LR
    A[管理者権限の確認] --> B{管理者権限あり?}
    B -- Yes --> C[レジストリのバックアップ]
    B -- No --> Z[エラーメッセージ: 管理者権限が必要です]
    C --> D[レジストリキーの存在確認]
    D --> E{キーが存在する?}
    E -- Yes --> F[DWORD値の作成/変更]
    E -- No --> G[キーを作成]
    G --> F
    F --> H[再起動の促し]
    H --> I[完了]
    Z --> I